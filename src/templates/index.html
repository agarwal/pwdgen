<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>pwdgen: modern password generation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Online password generation tool">
    <meta name="author" content="Sergey Yavnyi">

    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }

      #generatebutton {
        width: 150px;
      }

      .container-narrow {
        margin: 0 auto;
        max-width: 720px;
      }
      .container-narrow > hr {
        margin: 30px 0;
      }

      .jumbotron {
        margin: 60px 0;
        text-align: center;
      }
      .jumbotron h1 {
        font-size: 72px;
        line-height: 1;
      }

      #password {
        text-align: center;
      }
    </style>
  </head>

  <body>
    <div class="container-narrow">
      <div class="jumbotron">
        <h2>Grow a beard.</h2>
        <hr>
        <p class="lead">For those times when you realize that the last time the password was changed was approximately never.</p>

        <div class="input-group">
          <div class="input-group-btn">
            <button
              class="btn btn-primary btn-lg"
              id="generatebutton"
              data-loading-text="<span class='glyphicon glyphicon-refresh'></span> Working...">
              Click me!
            </button>
          </div>
          <input id="password" type="text" class="form-control input-lg" placeholder="Your password goes here...">
          <div class="input-group-btn">
            <button class="btn btn-default btn-lg" data-toggle="collapse" data-target="#templatesettings">
              <span class='glyphicon glyphicon-cog'></span>
            </button>
          </div>
        </div>

        <form id="templatesettings" class="collapse" role="form" action="#">
            <div class="form-group">
                <label for="passwordtemplate">Password template</label>
                <input class="form-control" type="text" name="t" id="passwordtemplate" placeholder="Password template goes here. For example, <adj><noun><00>" value="{{ password_template }}"></input>
            </div>
        </form>
        
      </div>

      <hr>

      <a href="http://xkcd.com/936/"><img src="http://imgs.xkcd.com/comics/password_strength.png" width="100%"/></a>

      <hr>

      <div class="footer">
        <p>&copy; <a href="http://reversemicrowave.me/">Sergey Yavnyi</a> 2013</p>
      </div>

    </div>

    <a href="https://github.com/blacktaxi/pwdgen"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.js"></script>
    <script src="/assets/js/bootstrap-flash.js"></script>

    <script>
      !function ($) {
        $(function () {
          $("#generatebutton").click(function () {
            $("#generatebutton").button('loading');
            $.ajax({
              type: "get",
              url: "/api/1/generate",
              data: "t=" + $("#passwordtemplate").val() + "&count=5"
            }).then(
              function (data, t, r) {
                $("#generatebutton").button('reset');
                if (data.error === undefined) {
                    if (data.passwords === undefined) {
                        window.showflash("Something went wrong.", true);
                    } else {
                        $("#password").val(data.passwords[Math.floor(Math.random() * data.passwords.length)]);
                        window.hideflash();
                    }
                } else {
                    window.showflash("Error: " + data.error, true);
                }
              },
              function (r, t, error) {
                $("#generatebutton").button('reset');
                window.showflash("Error: " + error, true);
              }
            );
          });

          $("#password").keydown(function (e) {
            if (e.which == 13) {
              $("#generatebutton").click();
            }
          });

          $("#password").focus();
          $("#generatebutton").click();

        });
      }(window.jQuery);
    </script>

  </body>
</html>
